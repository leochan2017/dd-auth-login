!function(e,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.ddAuthLogin=i():e.ddAuthLogin=i()}(window,function(){return function(e){var i={};function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var o in e)t.d(n,o,function(i){return e[i]}.bind(null,o));return n},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="",t(t.s="./src/index.js")}({"./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/*! exports provided: login, default */function(e,i,t){"use strict";t.r(i),t.d(i,"login",function(){return a});var n=function(){},o={libName:"ddAuthLogin",debug:!1,signUrl:"/data/labc-biz-dingding/dingTalk/getAuthInfo",ssoUrl:"/data/labc-biz-dingding/dingTalk/sso",success:n,fail:n,jsApiList:["runtime.permission.requestAuthCode","biz.util.datepicker","biz.util.timepicker","biz.util.datetimepicker","biz.ding.post","biz.telephone.call","biz.user.get","biz.contact.choose","biz.contact.createGroup","biz.contact.complexChoose","biz.util.chosen","biz.util.openLink","biz.util.uploadImage","biz.util.previewImage","biz.util.open","biz.util.share","biz.navigation.setTitle","biz.navigation.setLeft","biz.navigation.setRight","biz.navigation.close","biz.chat.pickConversation","biz.chat.chooseConversation","biz.chat.toConversation","biz.chat.chooseConversationByCorpId","biz.navigation.setIcon","ui.progressBar.setColors","ui.webViewBounce.disable","ui.input.plain","device.audio.startRecord","device.audio.stopRecord","device.audio.translateVoice","biz.telephone.showCallMenu","device.geolocation.get","biz.navigation.hideBar"]},r="undefined"==typeof console?{log:n,debug:n,error:n,warn:n,info:n}:console;function s(e){if((e=e||{}).type=(e.type||"GET").toUpperCase(),e.dataType=e.dataType||"json",window.XMLHttpRequest)var i=new XMLHttpRequest;else i=new ActiveXObject("Microsoft.XMLHTTP");i.onreadystatechange=function(){if(4==i.readyState){var t=i.status;t>=200&&t<300?e.success&&e.success(i.responseText,i.responseXML):e.fail&&e.fail(t)}},"GET"==e.type?(i.open("GET",e.url,!0),i.send(null)):"POST"==e.type&&(i.open("POST",e.url,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(e.data))}function u(){s({url:o.signUrl+"?url="+location.href,type:"GET",data:"",dataType:"json",success:function(e){if(e=JSON.parse(e),o.debug&&r.log("后台签名数据返回:",e),!e||void 0===e){var i="sign ajax is no result";return o.debug&&r.error(i),void o.fail(i)}const t=e.content;if(!t){i="sign: res.content is no data";return o.debug&&r.error(i),void o.fail(i)}var n;(dd.config({agentId:t.agentId,corpId:t.corpId,timeStamp:t.timeStamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:o.jsApiList}),dd.error(function(e){o.debug&&r.error(e),o.fail(e)}),t.hasLogin)?o.success("Login Success!"):(n=t.corpId,dd.ready(function(){dd.runtime.permission.requestAuthCode({corpId:n,onSuccess:function(e){if(!e||!e.code){var i="免登过程中获取钉钉code失败";return o.debug&&r.error(i),void o.fail(i)}s({url:o.ssoUrl+"?authCode="+e.code,type:"GET",data:null,dataType:"json",success:function(e){if(!e){var i="免登接口集合返回失败";return o.debug&&r.error(i),void o.fail(i)}o.success("Login Success!")},fail:function(e){o.debug&&r.error(e),o.fail(e)}})},onFail:function(e){o.debug&&r.error(e),o.fail(e)}})}))},fail:function(e){var i="sign ajax fail:"+JSON.stringify(e);o.debug&&r.error(i),o.fail(e)}})}function a(e){var i="undefined"==typeof dd?"请先引入钉钉的JSAPI再调用本库蛤":!dd.version&&"非钉钉环境本库不会运行哦";if(i)return r.error(i),void o.fail(i);if("object"!=typeof e){return r.error("啥参数都不传嘛?"),void o.fail("啥参数都不传嘛?")}void 0!==e.debug&&(o.debug=e.debug,e.debug&&r.warn("开启debug模式")),e.signUrl&&(o.signUrl=e.signUrl),e.ssoUrl&&(o.ssoUrl=e.ssoUrl),e.jsApiList&&(o.jsApiList=e.jsApiList),e.success&&(o.success=e.success),e.fail&&(o.fail=e.fail),o.debug&&r.log("当前入参:",o),u()}r.debug||(r.debug=n),i.default={login:a}}})});
//# sourceMappingURL=dd-auth-login.min.js.map