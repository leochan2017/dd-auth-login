!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){!function(t){var i=function(){},n={libName:"ddAuthLogin",debug:!1,getSignUrl:"/data/labc-biz-dingding/dingTalk/getAuthInfo",ssoUrl:"/data/labc-biz-dingding/dingTalk/sso",success:i,fail:i,jsApiList:["runtime.permission.requestAuthCode","biz.util.datepicker","biz.util.timepicker","biz.util.datetimepicker","biz.ding.post","biz.telephone.call","biz.user.get","biz.contact.choose","biz.contact.createGroup","biz.contact.complexChoose","biz.util.chosen","biz.util.openLink","biz.util.uploadImage","biz.util.previewImage","biz.util.open","biz.util.share","biz.navigation.setTitle","biz.navigation.setLeft","biz.navigation.setRight","biz.navigation.close","biz.chat.pickConversation","biz.chat.chooseConversation","biz.chat.toConversation","biz.chat.chooseConversationByCorpId","biz.navigation.setIcon","ui.progressBar.setColors","ui.webViewBounce.disable","ui.input.plain"]},o="undefined"==typeof console?{log:i,debug:i,error:i,warn:i,info:i}:console;if(o.debug||(o.debug=i),e.exports||void 0===t.ddAuthLogin){"undefined"==typeof dd&&o.error("请先引入 dd.js 再调用本库蛤");var r=function(e){if((e=e||{}).type=(e.type||"GET").toUpperCase(),e.dataType=e.dataType||"json",window.XMLHttpRequest)var t=new XMLHttpRequest;else t=new ActiveXObject("Microsoft.XMLHTTP");t.onreadystatechange=function(){if(4==t.readyState){var i=t.status;i>=200&&i<300?e.success&&e.success(t.responseText,t.responseXML):e.fail&&e.fail(i)}},"GET"==e.type?(t.open("GET",e.url,!0),t.send(null)):"POST"==e.type&&(t.open("POST",e.url,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(e.data))};n.login=function(e){"object"==typeof e?(void 0!==e.debug&&(n.debug=e.debug),e.getSignUrl&&(n.getSignUrl=e.getSignUrl),e.ssoUrl&&(n.ssoUrl=e.ssoUrl),e.jsApiList&&(n.jsApiList=e.jsApiList),e.success&&(n.success=e.success),e.fail&&(n.fail=e.fail),s()):n.debug&&o.error("啥参数都不传嘛?")},e.exports=n}else o.error("ddAuthLogin已经存在啦啦啦啦~");function s(){r({url:n.getSignUrl+"?url="+location.href,type:"GET",data:"",dataType:"json",success:function(e){if(e=JSON.parse(e),console.log("后台签名数据返回:",e),!e||void 0===e){var t="sign ajax is no result";return n.debug&&o.error(t),void n.fail(t)}const i=e.data.content;var s;(dd.config({agentId:i.agentId,corpId:i.corpId,timeStamp:i.timeStamp,nonceStr:i.nonceStr,signature:i.signature,jsApiList:n.jsApiList}),dd.error(function(e){n.debug&&o.error(e),n.fail(e)}),i.hasLogin)?n.success("Login Success!"):(s=i.corpId,dd.ready(function(){dd.runtime.permission.requestAuthCode({corpId:s,onSuccess:function(e){if(!e||!e.code){var t="免登过程中获取钉钉code失败";return n.debug&&o.error(t),void n.fail(t)}r({url:n.ssoUrl+"?authCode="+e.code,type:"GET",data:null,dataType:"json",success:function(e){if(!e){var t="免登接口集合返回失败";return n.debug&&o.error(t),void n.fail(t)}n.success("Login Success!")},fail:function(e){n.debug&&o.error(e),n.fail(e)}})},onFail:function(e){n.debug&&o.error(e),n.fail(e)}})}))},fail:function(e){var t="sign ajax fail:"+JSON.stringify(e);n.debug&&o.error(t),n.fail(e)}})}}(window)}]);